# 基于遗传算法的生产调度方法

由于生产调度问题的解容易进行编码，而且，遗传算法可以处理大规模问题，所以，遗传算法成为解决生产调度问题的重要方法。

# 1 基于遗传算法的流水车间调度方法

## 1.1 流水车间调度问题

流水车间调度问题（flow-shop scheduling problem，简称FSP）。

FSP一般可以描述位n个工件要在m台机器上加工，每个工件需要经过m道工序，每道工序要求不同的机器，n个工件m台机器上的加工顺序相同。工件再机器上的加工时间是给定的，设为$t_{ij}(i = 1, ..., n;j = 1, ..., m)$。问题的目标是确定n个工件再每台机器上的最优加工顺序，使最大流程时间达到最小。



# 2 基于遗传算法的混合流水车间调度方法

## 2.1 混合流水车间调度问题

混合流水车间调度问题（hybrid flow-shop scheduling problem，简称HFSP）是一般流水车间调度问题的推广，比一般的流水车间调度问题更复杂。它非常具有代表性，相当普遍地存在于化工、钢铁、制药等流程工业中，被称为**软性流水线**。

**HFSP可描述为**：需要加工多个工件，所有工件的加工路线都相同，都需要依次通过几道工序，在所有工序中至少有一个工序存在着多台机器。需要解决的问题是确定并行机器的分配情况以及同一台机器上工件的加工顺序。目标是最小化最大流程时间。

对于有N个工件，S个工序，每个工序i有$M_i$台并行机器（$1 \leq i \leq S$）的混合Flow-shop调度问题，已经提出了分枝定界算法、启发式算法等算法，但这些算法都只能解决规模较小的生产调度问题。

## 2.2 混合HFSP的遗传算法编码方法

下面给出一种HFSP的编码方法，能很好地处理工序之间的约束关系，使得产生的每个染色体都对应一个可行的调度，而且在进行遗传操作时也不会产生非法解。

假设要加工N个工件，每个工件都需要依次经过S个加工工序，每个工序的并行机器数为$M_i$，（i = 1, ..., S）。所有工序中至少有一个工序存在并行机，即至少有一个$M_i$大于1。下面构造一个SxN维的HFSP的编码矩阵：
$$
\begin{array}{l}
A_{S \times N} = 
    \begin{bmatrix}
    a_{11} & a_{12} & \cdots & a_{1N}      \\
    a_{21} & a_{22} & \cdots & a_{2N}      \\
    \vdots & \vdots &        & \vdots      \\
    a_{S1} & a_{S2} & \cdots & a_{SN}
    \end{bmatrix}
\end{array}
$$

- 元素$a_{ij}$为区间$(1, M_i + 1)$上的一个实数，表示工件j的第i个工序在第$Int(a_{ij})$台并行机上加工。
- 函数$Int(x)$表示对实数x取整。
  - 显然，可能出现$Int(a_{ij}) = Int(a_{ik}), j \neq k$，这表明多个工件在同一台机器上加工同一个工序。

加工顺序规则：假如第一个工序（i=1），则按照$a_{1j}$的升序来加工工件。加入不是第一道工序（$i \gt 1$），则根据每个工件的前一个工序的完成时间来确定其加工顺序，前一个工序先完成的先加工。假如完成时间相同，则也按照$a_{ij}$的升序来加工。

染色体：$Ind_k = [a_{11}, a_{12}, ..., a_{1N}, 0, a_{21}, a_{22}, ..., a_{2N}, 0, ..., a_{S1}, a_{S2}, ..., a_{SN}]$ 

- 染色体由S个小段组成；
  - 由编码矩阵的每一行组成一个小段。
  - 小段之间用标识符“0”隔开，表示不同的工序。
  - 每个小段包括N个基因；
- 染色体的长度：$S \times N + S - 1$

> 例如，对于有3个工件、3道工序、各工序的并行机器数分别为3，2，2的混合Flow-shop调度问题。
>
> 机器编号：
>
> 工序1：机器1	机器2	机器3
>
> 工序2：机器4	机器5
>
> 工序3：机器6	机器7
>
> 假设产生如下的编码矩阵：
> $$
> \begin{array}{l}
> A_{3 \times 3} = 
>     \begin{bmatrix}
>     2.1 & 2.4 & 1.9      \\
>     1.6 & 2.1 & 2.3      \\
>     1.1 & 2.4 & 1.2
>     \end{bmatrix}
> \end{array}
> $$
> 

